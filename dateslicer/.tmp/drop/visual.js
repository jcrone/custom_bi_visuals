var dateslicerDBDD84A5A032498BB55DDA8E91CBACB2;(()=>{"use strict";var t={294(t,e,i){var a=i(77),s=i(871);class n{static id="CalendarDialog";host;renderer;viewYear;viewMonth;rangeStart=null;rangeEnd=null;isRangeMode=!0;clickState="first";firstDayOfWeek=0;showSidebar=!0;minYear;maxYear;minDate=null;constructor(t,e){this.host=t.host,this.viewYear=e.viewYear,this.viewMonth=e.viewMonth,this.isRangeMode=e.isRangeMode,this.firstDayOfWeek=e.firstDayOfWeek,this.showSidebar=e.showSidebar,this.minYear=e.minYear,this.maxYear=e.maxYear,e.rangeStartISO&&(this.rangeStart=(0,s.yy)(new Date(e.rangeStartISO))),e.rangeEndISO&&(this.rangeEnd=(0,s.yy)(new Date(e.rangeEndISO))),e.minDateISO&&(this.minDate=(0,s.yy)(new Date(e.minDateISO)));const i=t.element;i.style.setProperty("--ds-accent",e.accentColor),i.style.setProperty("--ds-bg",e.bgColor),i.style.setProperty("--ds-text",e.textColor),i.style.setProperty("--ds-border",e.borderColor);const n={onPreset:t=>this.handlePreset(t),onDayClick:t=>this.handleDayClick(t),onTodayClick:()=>this.handlePreset("today"),onPrevMonth:()=>this.navigateMonth(-1),onNextMonth:()=>this.navigateMonth(1),onMonthSelect:t=>{this.viewMonth=t,this.renderAndSync()},onYearSelect:t=>{this.viewYear=t,this.renderAndSync()},onDateRangeToggle:t=>{this.isRangeMode=t,!t&&this.rangeStart&&(this.rangeEnd=this.rangeStart),this.renderAndSync()},onDaysUpToToday:t=>{this.setRange((0,s.hq)(t))},onDaysStartingToday:t=>{this.setRange((0,s.FC)(t))},onStartDateInput:t=>{const e=(0,s._U)(t);e&&(this.rangeStart=e,(!this.rangeEnd||e>this.rangeEnd)&&(this.rangeEnd=e),this.viewYear=e.getFullYear(),this.viewMonth=e.getMonth(),this.renderAndSync())},onEndDateInput:t=>{const e=(0,s._U)(t);e&&(this.rangeEnd=e,(!this.rangeStart||e<this.rangeStart)&&(this.rangeStart=e),this.renderAndSync())}};this.renderer=new a.U(i,n),this.renderer.setDisplayMode("expanded"),this.renderCalendar(),this.syncResult()}renderCalendar(){this.renderer.render(this.viewYear,this.viewMonth,this.firstDayOfWeek,this.rangeStart,this.rangeEnd,this.isRangeMode,this.showSidebar,this.minYear,this.maxYear)}renderAndSync(){this.renderCalendar(),this.syncResult()}syncResult(){const t={rangeStartISO:this.rangeStart?this.rangeStart.toISOString():null,rangeEndISO:this.rangeEnd?this.rangeEnd.toISOString():null,isRangeMode:this.isRangeMode,viewYear:this.viewYear,viewMonth:this.viewMonth};this.host.setResult(t)}handleDayClick(t){const e=(0,s.yy)(t);if(this.isRangeMode){if("first"===this.clickState)return this.rangeStart=e,this.rangeEnd=null,this.clickState="second",void this.renderCalendar();this.rangeStart&&e<this.rangeStart?(this.rangeEnd=this.rangeStart,this.rangeStart=e):this.rangeEnd=e,this.clickState="first"}else this.rangeStart=e,this.rangeEnd=e;this.renderAndSync()}handlePreset(t){const e=(0,s.p4)(t,this.firstDayOfWeek,this.minDate||void 0);this.setRange(e)}setRange(t){this.rangeStart=t.start,this.rangeEnd=t.end,this.viewYear=t.start.getFullYear(),this.viewMonth=t.start.getMonth(),this.clickState="first",this.renderAndSync()}navigateMonth(t){this.viewMonth+=t,this.viewMonth>11?(this.viewMonth=0,this.viewYear++):this.viewMonth<0&&(this.viewMonth=11,this.viewYear--),this.renderAndSync()}}globalThis.dialogRegistry||(globalThis.dialogRegistry={}),globalThis.dialogRegistry[n.id]=n},77(t,e,i){i.d(e,{U:()=>s});var a=i(871);class s{root;callbacks;pill;pillText;pillChevron;dropdown;wrapper;sidebar;mainPanel;gridBody;dayHeaders;startInput;endInput;dateRangeToggle;daysUpInput;daysStartInput;monthDropdown;yearDropdown;currentMode="expanded";isDropdownOpen=!1;cachedMinYear=0;cachedMaxYear=0;outsideClickHandler;constructor(t,e){this.root=t,this.callbacks=e,this.outsideClickHandler=t=>this.handleOutsideClick(t),this.buildDOM()}buildDOM(){for(;this.root.firstChild;)this.root.removeChild(this.root.firstChild);this.root.style.position="relative",this.root.style.overflow="visible",this.pill=this.el("div","ds-pill");const t=this.buildPillIcon();this.pill.appendChild(t),this.pillText=this.el("span","ds-pill__text"),this.pillText.textContent="Select date…",this.pill.appendChild(this.pillText),this.pillChevron=this.el("span","ds-pill__chevron"),this.pillChevron.textContent="▾",this.pill.appendChild(this.pillChevron),this.pill.style.display="none",this.pill.addEventListener("click",t=>{t.stopPropagation(),this.callbacks.onCompactOpen?this.callbacks.onCompactOpen():this.isDropdownOpen?this.closeDropdown():this.openDropdown()}),this.root.appendChild(this.pill),this.wrapper=this.el("div","ds-wrapper"),this.sidebar=this.el("div","ds-sidebar");const e=this.el("div","ds-toggle-row");this.dateRangeToggle=document.createElement("input"),this.dateRangeToggle.type="checkbox",this.dateRangeToggle.className="ds-toggle",this.dateRangeToggle.checked=!0,this.dateRangeToggle.addEventListener("change",()=>{this.callbacks.onDateRangeToggle(this.dateRangeToggle.checked)});const i=this.el("span","ds-toggle-label");i.textContent="Date Range",e.appendChild(this.dateRangeToggle),e.appendChild(i),this.sidebar.appendChild(e);const s=[{key:"yesterday",label:"Yesterday"},{key:"today",label:"Today"},{key:"minDate",label:"Min Date"},{key:"thisWeek",label:"This Week"},{key:"lastWeek",label:"Last Week"},{key:"thisMonth",label:"This Month"}];for(const t of s){const e=this.el("button","ds-preset-btn");e.textContent=t.label,e.addEventListener("click",()=>this.callbacks.onPreset(t.key)),this.sidebar.appendChild(e)}const n=this.el("div","ds-days-row");this.daysUpInput=document.createElement("input"),this.daysUpInput.type="number",this.daysUpInput.className="ds-days-input",this.daysUpInput.min="1",this.daysUpInput.value="7",this.daysUpInput.addEventListener("change",()=>{const t=parseInt(this.daysUpInput.value,10);t>0&&this.callbacks.onDaysUpToToday(t)});const r=this.el("span","ds-days-label");r.textContent="days up to today",n.appendChild(this.daysUpInput),n.appendChild(r),this.sidebar.appendChild(n);const o=this.el("div","ds-days-row");this.daysStartInput=document.createElement("input"),this.daysStartInput.type="number",this.daysStartInput.className="ds-days-input",this.daysStartInput.min="1",this.daysStartInput.value="7",this.daysStartInput.addEventListener("change",()=>{const t=parseInt(this.daysStartInput.value,10);t>0&&this.callbacks.onDaysStartingToday(t)});const l=this.el("span","ds-days-label");l.textContent="days starting today",o.appendChild(this.daysStartInput),o.appendChild(l),this.sidebar.appendChild(o),this.wrapper.appendChild(this.sidebar),this.mainPanel=this.el("div","ds-main");const d=this.el("div","ds-top-row"),h=this.el("button","ds-today-btn");h.textContent="Today",h.addEventListener("click",()=>this.callbacks.onTodayClick()),d.appendChild(h);const c=this.el("button","ds-close-btn");c.textContent="✕",c.title="Close",c.addEventListener("click",()=>this.close()),d.appendChild(c),this.mainPanel.appendChild(d);const p=this.el("div","ds-input-row");this.startInput=document.createElement("input"),this.startInput.type="text",this.startInput.className="ds-date-input",this.startInput.placeholder="MM/DD/YYYY",this.startInput.addEventListener("change",()=>{this.callbacks.onStartDateInput(this.startInput.value)}),this.endInput=document.createElement("input"),this.endInput.type="text",this.endInput.className="ds-date-input",this.endInput.placeholder="MM/DD/YYYY",this.endInput.addEventListener("change",()=>{this.callbacks.onEndDateInput(this.endInput.value)}),p.appendChild(this.startInput),p.appendChild(this.endInput),this.mainPanel.appendChild(p);const g=this.el("div","ds-nav-row"),u=this.el("button","ds-nav-btn");u.textContent="❮",u.addEventListener("click",()=>this.callbacks.onPrevMonth()),this.monthDropdown=document.createElement("select"),this.monthDropdown.className="ds-month-select";for(let t=0;t<12;t++){const e=document.createElement("option");e.value=String(t),e.textContent=a.oy[t],this.monthDropdown.appendChild(e)}this.monthDropdown.addEventListener("change",()=>{this.callbacks.onMonthSelect(parseInt(this.monthDropdown.value,10))}),this.yearDropdown=document.createElement("select"),this.yearDropdown.className="ds-year-select",this.yearDropdown.addEventListener("change",()=>{this.callbacks.onYearSelect(parseInt(this.yearDropdown.value,10))});const y=this.el("button","ds-nav-btn");y.textContent="❯",y.addEventListener("click",()=>this.callbacks.onNextMonth()),g.appendChild(u),g.appendChild(this.monthDropdown),g.appendChild(this.yearDropdown),g.appendChild(y),this.mainPanel.appendChild(g),this.dayHeaders=this.el("div","ds-day-headers"),this.mainPanel.appendChild(this.dayHeaders),this.gridBody=this.el("div","ds-grid"),this.mainPanel.appendChild(this.gridBody),this.wrapper.appendChild(this.mainPanel),this.root.appendChild(this.wrapper),this.dropdown=this.el("div","ds-dropdown"),this.dropdown.style.display="none",this.dropdown.addEventListener("click",t=>t.stopPropagation()),document.body.appendChild(this.dropdown)}render(t,e,i,s,n,r,o,l,d){if(this.sidebar.style.display=o?"":"none",this.endInput.style.display=r?"":"none",this.startInput.value=s?(0,a.Yq)(s):"",this.endInput.value=n?(0,a.Yq)(n):"",this.monthDropdown.value=String(e),l!==this.cachedMinYear||d!==this.cachedMaxYear){for(this.cachedMinYear=l,this.cachedMaxYear=d;this.yearDropdown.firstChild;)this.yearDropdown.removeChild(this.yearDropdown.firstChild);for(let t=l;t<=d;t++){const e=document.createElement("option");e.value=String(t),e.textContent=String(t),this.yearDropdown.appendChild(e)}}this.yearDropdown.value=String(t);const h=1===i?a.X9:a.l6;for(;this.dayHeaders.firstChild;)this.dayHeaders.removeChild(this.dayHeaders.firstChild);for(const t of h){const e=this.el("div","ds-day-header");e.textContent=t,this.dayHeaders.appendChild(e)}const c=(0,a.yM)(t,e,i,s,n);for(;this.gridBody.firstChild;)this.gridBody.removeChild(this.gridBody.firstChild);for(const t of c)for(const e of t){const t=this.el("div","ds-day-cell");t.textContent=String(e.day),e.isCurrentMonth||t.classList.add("ds-day--other"),e.isToday&&t.classList.add("ds-day--today"),e.isInRange&&t.classList.add("ds-day--in-range"),e.isRangeStart&&t.classList.add("ds-day--range-start"),e.isRangeEnd&&t.classList.add("ds-day--range-end"),e.isRangeStart&&e.isRangeEnd&&t.classList.add("ds-day--single"),t.addEventListener("click",()=>{this.callbacks.onDayClick(e.date)}),this.gridBody.appendChild(t)}this.dateRangeToggle.checked=r,this.pillText.textContent=s&&n?`${(0,a.Yq)(s)} — ${(0,a.Yq)(n)}`:s?(0,a.Yq)(s):"Select date…","compact"===this.currentMode&&this.isDropdownOpen&&this.positionDropdown()}setDisplayMode(t){this.currentMode=t,"compact"===t?(this.pill.style.display="",this.isDropdownOpen||(this.wrapper.style.display="none"),this.wrapper.classList.add("ds-wrapper--popup")):(this.pill.style.display="none",this.isDropdownOpen&&this.closeDropdown(),this.wrapper.parentElement!==this.root&&this.root.appendChild(this.wrapper),this.wrapper.style.display="",this.wrapper.classList.remove("ds-wrapper--popup"),this.dropdown.style.display="none")}openDropdown(){this.isDropdownOpen||(this.isDropdownOpen=!0,this.dropdown.appendChild(this.wrapper),this.positionDropdown(),this.wrapper.style.display="",this.dropdown.style.display="",this.pillChevron.classList.add("ds-pill__chevron--open"),setTimeout(()=>{document.addEventListener("click",this.outsideClickHandler)},0))}positionDropdown(){const t=this.pill.getBoundingClientRect();this.dropdown.style.position="fixed",this.dropdown.style.left=`${t.left}px`,this.dropdown.style.top=`${t.bottom+4}px`,this.dropdown.style.width=`${Math.max(t.width,320)}px`}closeDropdown(){this.isDropdownOpen&&(this.isDropdownOpen=!1,this.root.appendChild(this.wrapper),"compact"===this.currentMode&&(this.wrapper.style.display="none"),this.dropdown.style.display="none",this.pillChevron.classList.remove("ds-pill__chevron--open"),document.removeEventListener("click",this.outsideClickHandler))}handleOutsideClick(t){const e=t.target;this.dropdown.contains(e)||this.pill.contains(e)||this.closeDropdown()}close(){"compact"===this.currentMode&&this.isDropdownOpen&&this.closeDropdown()}destroy(){document.removeEventListener("click",this.outsideClickHandler),this.dropdown.parentElement&&this.dropdown.parentElement.removeChild(this.dropdown)}setCompact(t){t?this.wrapper.classList.add("ds-wrapper--compact"):this.wrapper.classList.remove("ds-wrapper--compact")}buildPillIcon(){const t="http://www.w3.org/2000/svg",e=document.createElementNS(t,"svg");e.setAttribute("class","ds-pill__icon"),e.setAttribute("width","16"),e.setAttribute("height","16"),e.setAttribute("viewBox","0 0 16 16"),e.setAttribute("fill","none");const i=document.createElementNS(t,"rect");i.setAttribute("x","1"),i.setAttribute("y","2"),i.setAttribute("width","14"),i.setAttribute("height","13"),i.setAttribute("rx","2"),i.setAttribute("stroke","currentColor"),i.setAttribute("stroke-width","1.5"),i.setAttribute("fill","none"),e.appendChild(i);const a=document.createElementNS(t,"line");a.setAttribute("x1","1"),a.setAttribute("y1","6"),a.setAttribute("x2","15"),a.setAttribute("y2","6"),a.setAttribute("stroke","currentColor"),a.setAttribute("stroke-width","1.5"),e.appendChild(a);const s=document.createElementNS(t,"line");s.setAttribute("x1","5"),s.setAttribute("y1","1"),s.setAttribute("x2","5"),s.setAttribute("y2","3.5"),s.setAttribute("stroke","currentColor"),s.setAttribute("stroke-width","1.5"),s.setAttribute("stroke-linecap","round"),e.appendChild(s);const n=document.createElementNS(t,"line");return n.setAttribute("x1","11"),n.setAttribute("y1","1"),n.setAttribute("x2","11"),n.setAttribute("y2","3.5"),n.setAttribute("stroke","currentColor"),n.setAttribute("stroke-width","1.5"),n.setAttribute("stroke-linecap","round"),e.appendChild(n),e}el(t,e){const i=document.createElement(t);return i.className=e,i}}},871(t,e,i){function a(){return s(new Date)}function s(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate())}function n(t){return`${String(t.getMonth()+1).padStart(2,"0")}/${String(t.getDate()).padStart(2,"0")}/${t.getFullYear()}`}function r(t){const e=t.split("/");if(3!==e.length)return null;const i=parseInt(e[0],10)-1,a=parseInt(e[1],10),s=parseInt(e[2],10);if(isNaN(i)||isNaN(a)||isNaN(s))return null;const n=new Date(s,i,a);return n.getMonth()!==i||n.getDate()!==a?null:n}function o(t,e){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()}function l(t,e,i){const a=s(t).getTime();return a>=s(e).getTime()&&a<=s(i).getTime()}function d(t,e){const i=new Date(t);return i.setDate(i.getDate()+e),s(i)}function h(t,e){const i=new Date(t),a=(i.getDay()-e+7)%7;return i.setDate(i.getDate()-a),s(i)}function c(t,e){return d(h(t,e),6)}function p(t){return new Date(t.getFullYear(),t.getMonth()+1,0)}function g(t,e,i){const s=a();switch(t){case"yesterday":{const t=d(s,-1);return{start:t,end:t}}case"today":default:return{start:s,end:s};case"minDate":return{start:i||s,end:s};case"thisWeek":return{start:h(s,e),end:c(s,e)};case"lastWeek":{const t=d(s,-7);return{start:h(t,e),end:c(t,e)}}case"thisMonth":return{start:(n=s,new Date(n.getFullYear(),n.getMonth(),1)),end:p(s)}}var n}function u(t){const e=a();return{start:d(e,-(t-1)),end:e}}function y(t){const e=a();return{start:e,end:d(e,t-1)}}function m(t,e,i,s,n){const r=new Date(t,e,1),d=new Date(t,e+1,0),c=a(),p=h(r,i),g=[];let u=new Date(p);for(let t=0;t<6;t++){const t=[];for(let i=0;i<7;i++){const i=new Date(u),a=i.getMonth()===e,r=o(i,c);let d=!1,h=!1,p=!1;s&&n&&(d=l(i,s,n),h=o(i,s),p=o(i,n)),t.push({date:i,day:i.getDate(),isCurrentMonth:a,isToday:r,isInRange:d,isRangeStart:h,isRangeEnd:p}),u.setDate(u.getDate()+1)}if(g.push(t),u>d&&u.getDay()===i)break}return g}i.d(e,{Ec:()=>a,FC:()=>y,X9:()=>w,Yq:()=>n,_U:()=>r,hq:()=>u,l6:()=>S,oy:()=>v,p4:()=>g,yM:()=>m,yy:()=>s});const v=["January","February","March","April","May","June","July","August","September","October","November","December"],S=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],w=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]},213(t,e,i){i.d(e,{S:()=>l});var a=i(674),s=a.z.Tn,n=a.z.Kx;class r extends s{firstDayOfWeek=new a.z.PA({name:"firstDayOfWeek",displayName:"First day of week",items:[{value:"0",displayName:"Sunday"},{value:"1",displayName:"Monday"}],value:{value:"0",displayName:"Sunday"}});showSidebar=new a.z.jF({name:"showSidebar",displayName:"Show sidebar",value:!0});defaultPreset=new a.z.PA({name:"defaultPreset",displayName:"Default preset",items:[{value:"none",displayName:"None"},{value:"today",displayName:"Today"},{value:"thisWeek",displayName:"This Week"},{value:"thisMonth",displayName:"This Month"},{value:"lastWeek",displayName:"Last Week"}],value:{value:"none",displayName:"None"}});displayMode=new a.z.PA({name:"displayMode",displayName:"Display mode",items:[{value:"expanded",displayName:"Expanded"},{value:"compact",displayName:"Compact"}],value:{value:"compact",displayName:"Compact"}});name="calendar";displayName="Calendar";slices=[this.firstDayOfWeek,this.showSidebar,this.defaultPreset,this.displayMode]}class o extends s{accentColor=new a.z.sk({name:"accentColor",displayName:"Accent color",value:{value:"#00539A"}});backgroundColor=new a.z.sk({name:"backgroundColor",displayName:"Background color",value:{value:"#FFFFFF"}});textColor=new a.z.sk({name:"textColor",displayName:"Text color",value:{value:"#11284C"}});borderColor=new a.z.sk({name:"borderColor",displayName:"Border color",value:{value:"#D9E1EA"}});name="appearance";displayName="Appearance";slices=[this.accentColor,this.backgroundColor,this.textColor,this.borderColor]}class l extends n{calendarCard=new r;appearanceCard=new o;cards=[this.calendarCard,this.appearanceCard]}},164(t,e,i){i.d(e,{b:()=>o});var a=i(674),s=i(213),n=i(77),r=i(871);i(294);class o{host;events;target;formattingSettings;formattingSettingsService;renderer;viewYear;viewMonth;rangeStart=null;rangeEnd=null;isRangeMode=!0;clickState="first";columnTarget=null;minDate=null;maxDate=null;initialized=!1;filterRestored=!1;constructor(t){this.host=t.host,this.events=t.host.eventService,this.target=t.element,this.formattingSettingsService=new a.O;const e=(0,r.Ec)();this.viewYear=e.getFullYear(),this.viewMonth=e.getMonth();const i={onPreset:t=>this.handlePreset(t),onDayClick:t=>this.handleDayClick(t),onTodayClick:()=>this.handlePreset("today"),onPrevMonth:()=>this.navigateMonth(-1),onNextMonth:()=>this.navigateMonth(1),onMonthSelect:t=>{this.viewMonth=t,this.renderCalendar()},onYearSelect:t=>{this.viewYear=t,this.renderCalendar()},onDateRangeToggle:t=>{this.isRangeMode=t,!t&&this.rangeStart&&(this.rangeEnd=this.rangeStart),this.renderCalendar(),this.applyFilter()},onDaysUpToToday:t=>{const e=(0,r.hq)(t);this.setRange(e)},onDaysStartingToday:t=>{const e=(0,r.FC)(t);this.setRange(e)},onStartDateInput:t=>{const e=(0,r._U)(t);e&&(this.rangeStart=e,(!this.rangeEnd||e>this.rangeEnd)&&(this.rangeEnd=e),this.viewYear=e.getFullYear(),this.viewMonth=e.getMonth(),this.renderCalendar(),this.applyFilter())},onEndDateInput:t=>{const e=(0,r._U)(t);e&&(this.rangeEnd=e,(!this.rangeStart||e<this.rangeStart)&&(this.rangeStart=e),this.renderCalendar(),this.applyFilter())},onCompactOpen:()=>this.openCalendarDialog()};this.renderer=new n.U(this.target,i)}update(t){if(this.events.renderingStarted(t),!t.dataViews||!t.dataViews[0])return void this.events.renderingFinished(t);const e=t.dataViews[0];if(this.formattingSettings=this.formattingSettingsService.populateFormattingSettingsModel(s.S,e),e.categorical&&e.categorical.categories&&e.categorical.categories.length>0){const t=e.categorical.categories[0],i=t.source.queryName;if(i){const t=i.split(".");this.columnTarget={table:t[0],column:t.length>1?t[1]:t[0]}}const a=t.values;if(a&&a.length>0){let t=null,e=null;for(const i of a){if(null==i)continue;const a=new Date(i);if(isNaN(a.getTime()))continue;const s=(0,r.yy)(a);(!t||s<t)&&(t=s),(!e||s>e)&&(e=s)}this.minDate=t,this.maxDate=e}}if(!this.filterRestored){this.filterRestored=!0;const e=t.jsonFilters;if(e&&e.length>0){const t=e[0];if(t&&t.conditions&&t.conditions.length>=1){for(const e of t.conditions){if("GreaterThanOrEqual"===e.operator&&null!=e.value){const t=new Date(e.value);isNaN(t.getTime())||(this.rangeStart=(0,r.yy)(t))}if("LessThanOrEqual"===e.operator&&null!=e.value){const t=new Date(e.value);isNaN(t.getTime())||(this.rangeEnd=(0,r.yy)(t))}}this.rangeStart&&(this.viewYear=this.rangeStart.getFullYear(),this.viewMonth=this.rangeStart.getMonth())}}else if(!this.initialized){const t=String(this.formattingSettings.calendarCard.defaultPreset.value.value);if(t&&"none"!==t){const e=parseInt(String(this.formattingSettings.calendarCard.firstDayOfWeek.value.value),10),i=(0,r.p4)(t,e,this.minDate||void 0);this.rangeStart=i.start,this.rangeEnd=i.end,this.viewYear=i.start.getFullYear(),this.viewMonth=i.start.getMonth(),this.applyFilter()}}this.initialized=!0}const i=this.formattingSettings.appearanceCard.accentColor.value.value,a=this.formattingSettings.appearanceCard.backgroundColor.value.value,n=this.formattingSettings.appearanceCard.textColor.value.value,o=this.formattingSettings.appearanceCard.borderColor.value.value;this.target.style.setProperty("--ds-accent",i),this.target.style.setProperty("--ds-bg",a),this.target.style.setProperty("--ds-text",n),this.target.style.setProperty("--ds-border",o);const l=String(this.formattingSettings.calendarCard.displayMode.value.value);this.renderer.setDisplayMode(l);const d=t.viewport;this.renderer.setCompact(d.width<350||d.height<300),this.renderCalendar(),this.events.renderingFinished(t)}renderCalendar(){const t=this.formattingSettings?parseInt(String(this.formattingSettings.calendarCard.firstDayOfWeek.value.value),10):0,e=!this.formattingSettings||this.formattingSettings.calendarCard.showSidebar.value,i=this.minDate?this.minDate.getFullYear():this.viewYear-10,a=this.maxDate?this.maxDate.getFullYear():this.viewYear+10;this.renderer.render(this.viewYear,this.viewMonth,t,this.rangeStart,this.rangeEnd,this.isRangeMode,e,i,a)}handleDayClick(t){const e=(0,r.yy)(t);if(this.isRangeMode){if("first"===this.clickState)return this.rangeStart=e,this.rangeEnd=null,this.clickState="second",void this.renderCalendar();this.rangeStart&&e<this.rangeStart?(this.rangeEnd=this.rangeStart,this.rangeStart=e):this.rangeEnd=e,this.clickState="first"}else this.rangeStart=e,this.rangeEnd=e;this.renderCalendar(),this.applyFilter()}handlePreset(t){const e=this.formattingSettings?parseInt(String(this.formattingSettings.calendarCard.firstDayOfWeek.value.value),10):0,i=(0,r.p4)(t,e,this.minDate||void 0);this.setRange(i)}setRange(t){this.rangeStart=t.start,this.rangeEnd=t.end,this.viewYear=t.start.getFullYear(),this.viewMonth=t.start.getMonth(),this.clickState="first",this.renderCalendar(),this.applyFilter()}applyFilter(){if(!this.columnTarget||!this.rangeStart)return;const t=this.rangeEnd||this.rangeStart,e=new Date(t.getFullYear(),t.getMonth(),t.getDate(),23,59,59,999),i={$schema:"https://powerbi.com/product/schema#advanced",filterType:0,target:{table:this.columnTarget.table,column:this.columnTarget.column},logicalOperator:"And",conditions:[{operator:"GreaterThanOrEqual",value:this.rangeStart.toISOString()},{operator:"LessThanOrEqual",value:e.toISOString()}]};this.host.applyJsonFilter(i,"general","filter",0)}openCalendarDialog(){const t=this.formattingSettings?parseInt(String(this.formattingSettings.calendarCard.firstDayOfWeek.value.value),10):0,e=!this.formattingSettings||this.formattingSettings.calendarCard.showSidebar.value,i=this.minDate?this.minDate.getFullYear():this.viewYear-10,a=this.maxDate?this.maxDate.getFullYear():this.viewYear+10,s=this.formattingSettings?this.formattingSettings.appearanceCard.accentColor.value.value:"#00539A",n=this.formattingSettings?this.formattingSettings.appearanceCard.backgroundColor.value.value:"#FFFFFF",o=this.formattingSettings?this.formattingSettings.appearanceCard.textColor.value.value:"#11284C",l=this.formattingSettings?this.formattingSettings.appearanceCard.borderColor.value.value:"#D9E1EA",d={viewYear:this.viewYear,viewMonth:this.viewMonth,rangeStartISO:this.rangeStart?this.rangeStart.toISOString():null,rangeEndISO:this.rangeEnd?this.rangeEnd.toISOString():null,isRangeMode:this.isRangeMode,firstDayOfWeek:t,showSidebar:e,minYear:i,maxYear:a,minDateISO:this.minDate?this.minDate.toISOString():null,accentColor:s,bgColor:n,textColor:o,borderColor:l};this.host.openModalDialog("CalendarDialog",{title:"Select Date Range",size:{width:560,height:420},position:{type:0},actionButtons:[1,2]},d).then(t=>{if(1===t.actionId){const e=t.resultState;e&&(this.isRangeMode=e.isRangeMode,this.viewYear=e.viewYear,this.viewMonth=e.viewMonth,this.rangeStart=e.rangeStartISO?(0,r.yy)(new Date(e.rangeStartISO)):null,this.rangeEnd=e.rangeEndISO?(0,r.yy)(new Date(e.rangeEndISO)):null,this.clickState="first",this.renderCalendar(),this.applyFilter())}})}navigateMonth(t){this.viewMonth+=t,this.viewMonth>11?(this.viewMonth=0,this.viewYear++):this.viewMonth<0&&(this.viewMonth=11,this.viewYear--),this.renderCalendar()}destroy(){this.renderer.destroy()}getFormattingModel(){return this.formattingSettings||(this.formattingSettings=new s.S),this.formattingSettingsService.buildFormattingModel(this.formattingSettings)}}},754(t,e,i){i.d(e,{Kx:()=>r,PA:()=>p,St:()=>o,Tn:()=>l,jF:()=>h,sk:()=>c});var a=i(639);class s{}class n extends s{}class r{}class o extends s{}class l extends n{}class d extends s{constructor(t){super(),Object.assign(this,t)}getFormattingSlice(t,e){const i=this.type,a=this.name,s={displayName:e&&this.displayNameKey?e.getDisplayName(this.displayNameKey):this.displayName,description:e&&this.descriptionKey?e.getDisplayName(this.descriptionKey):this.description,uid:t+"-"+a};return Object.assign(Object.assign({},s),{control:{type:i,properties:this.getFormattingComponent(t,e)}})}getFormattingComponent(t,e){return{descriptor:a.y(t,this),value:this.value}}getRevertToDefaultDescriptor(t){return[{objectName:t,propertyName:this.name}]}setPropertiesValues(t,e){var i;const s=null===(i=null==t?void 0:t[e])||void 0===i?void 0:i[this.name];this.value=a.D(this,s,this.value)}}class h extends d{constructor(t){super(t),this.type="ToggleSwitch"}}class c extends d{constructor(t){super(t),this.type="ColorPicker"}getFormattingComponent(t){return Object.assign(Object.assign({},super.getFormattingComponent(t)),{defaultColor:this.defaultColor,isNoFillItemSupported:this.isNoFillItemSupported})}}class p extends d{constructor(t){super(t),this.type="Dropdown"}getFormattingComponent(t){return Object.assign(Object.assign({},super.getFormattingComponent(t)),{items:this.items})}}},667(t,e,i){i.d(e,{A:()=>s});var a=i(754);const s=class{constructor(t){this.localizationManager=t}populateFormattingSettingsModel(t,e){var i,s;const n=new t,r=null===(i=null==e?void 0:e.metadata)||void 0===i?void 0:i.objects;return r&&(null===(s=n.cards)||void 0===s||s.forEach(t=>{var e;t instanceof a.St&&(null===(e=t.topLevelSlice)||void 0===e||e.setPropertiesValues(r,t.name)),(t instanceof a.Tn?[t]:t.groups).forEach(e=>{var i,a,s,n;null===(i=e.topLevelSlice)||void 0===i||i.setPropertiesValues(r,t.name),null===(a=null==e?void 0:e.slices)||void 0===a||a.forEach(e=>{null==e||e.setPropertiesValues(r,t.name)}),null===(n=null===(s=null==e?void 0:e.container)||void 0===s?void 0:s.containerItems)||void 0===n||n.forEach(e=>{var i;null===(i=null==e?void 0:e.slices)||void 0===i||i.forEach(e=>{null==e||e.setPropertiesValues(r,t.name)})})})})),n}buildFormattingModel(t){const e={cards:[]};return t.cards.filter(({visible:t=!0})=>t).forEach(t=>{var i;const s={displayName:this.localizationManager&&t.displayNameKey?this.localizationManager.getDisplayName(t.displayNameKey):t.displayName,description:this.localizationManager&&t.descriptionKey?this.localizationManager.getDisplayName(t.descriptionKey):t.description,groups:[],uid:t.name+"-card",analyticsPane:t.analyticsPane},n=t.name;if(t.topLevelSlice){const e=t.topLevelSlice.getFormattingSlice(n,this.localizationManager);e.suppressDisplayName=!0,s.topLevelToggle=e}null===(i=t.onPreProcess)||void 0===i||i.call(t);const r=t instanceof a.Tn;(r?[t].filter(({visible:t=!0})=>t):t.groups.filter(({visible:t=!0})=>t)).forEach(t=>{const e=t.name+"-group",i={displayName:r?void 0:this.localizationManager&&t.displayNameKey?this.localizationManager.getDisplayName(t.displayNameKey):t.displayName,description:r?void 0:this.localizationManager&&t.descriptionKey?this.localizationManager.getDisplayName(t.descriptionKey):t.description,slices:[],uid:e,collapsible:t.collapsible,delaySaveSlices:t.delaySaveSlices,disabled:t.disabled,disabledReason:t.disabledReason};s.groups.push(i);const a={};if(t.container){const s=t.container,r=e+"-container",o={displayName:this.localizationManager&&s.displayNameKey?this.localizationManager.getDisplayName(s.displayNameKey):s.displayName,description:this.localizationManager&&s.descriptionKey?this.localizationManager.getDisplayName(s.descriptionKey):s.description,containerItems:[],uid:r};s.containerItems.forEach(t=>{const e=t.displayNameKey?t.displayNameKey:t.displayName,i=r+e,s={displayName:this.localizationManager&&t.displayNameKey?this.localizationManager.getDisplayName(t.displayNameKey):t.displayName,slices:[],uid:i};this.buildFormattingSlices({slices:t.slices,objectName:n,sliceNames:a,formattingSlices:s.slices}),o.containerItems.push(s)}),i.container=o}if(t.slices){if(t.topLevelSlice){const e=t.topLevelSlice.getFormattingSlice(n,this.localizationManager);e.suppressDisplayName=!0,(null==i.displayName?s:i).topLevelToggle=e}this.buildFormattingSlices({slices:t.slices,objectName:n,sliceNames:a,formattingSlices:i.slices})}}),s.revertToDefaultDescriptors=this.getRevertToDefaultDescriptor(t),e.cards.push(s)}),e}buildFormattingSlices({slices:t,objectName:e,sliceNames:i,formattingSlices:a}){null==t||t.filter(({visible:t=!0})=>t).forEach(t=>{const s=null==t?void 0:t.getFormattingSlice(e,this.localizationManager);s&&(void 0===i[t.name]?i[t.name]=0:(i[t.name]++,s.uid=`${s.uid}-${i[t.name]}`),a.push(s))})}getRevertToDefaultDescriptor(t){var e;const i={},s=[];let n,r=[];return t instanceof a.St&&t.topLevelSlice&&s.push(...null===(e=t.topLevelSlice)||void 0===e?void 0:e.getRevertToDefaultDescriptor(t.name)),(t instanceof a.Tn?[t].filter(({visible:t=!0})=>t):t.groups.filter(({visible:t=!0})=>t)).forEach(e=>{var a,o;n=this.getSlicesRevertToDefaultDescriptor(t.name,e.slices,i,e.topLevelSlice),null===(o=null===(a=e.container)||void 0===a?void 0:a.containerItems)||void 0===o||o.forEach(e=>{r=r.concat(this.getSlicesRevertToDefaultDescriptor(t.name,e.slices,i))}),s.push(...n.concat(r))}),s}getSlicesRevertToDefaultDescriptor(t,e,i,a){let s=[];return a&&(i[a.name]=!0,s=s.concat(a.getRevertToDefaultDescriptor(t))),null==e||e.forEach(e=>{e&&!i[e.name]&&(i[e.name]=!0,s=s.concat(e.getRevertToDefaultDescriptor(t)))}),s}}},674(t,e,i){i.d(e,{O:()=>s.A,z:()=>a});var a=i(754),s=i(667)},639(t,e,i){function a(t,e){return{objectName:t,propertyName:e.name,selector:e.selector,altConstantValueSelector:e.altConstantSelector,instanceKind:e.instanceKind}}function s(t,e,i){return null==e||"object"==typeof e&&!e.solid?i:e.solid?{value:null==e?void 0:e.solid.color}:"Dropdown"===(null==t?void 0:t.type)&&t.items?t.items.find(t=>t.value==e):e}i.d(e,{D:()=>s,y:()=>a})}},e={};function i(a){var s=e[a];if(void 0!==s)return s.exports;var n=e[a]={exports:{}};return t[a](n,n.exports,i),n.exports}i.d=(t,e)=>{for(var a in e)i.o(e,a)&&!i.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var a={};(()=>{i.r(a),i.d(a,{default:()=>n});var t=i(164),e=window.powerbi,s={name:"dateslicerDBDD84A5A032498BB55DDA8E91CBACB2",displayName:"Date Slicer",class:"Visual",apiVersion:"5.3.0",create:e=>{if(t.b)return new t.b(e);throw"Visual instance not found"},createModalDialog:(t,e,i)=>{const a=globalThis.dialogRegistry;t in a&&new a[t](e,i)},custom:!0};void 0!==e&&(e.visuals=e.visuals||{},e.visuals.plugins=e.visuals.plugins||{},e.visuals.plugins.dateslicerDBDD84A5A032498BB55DDA8E91CBACB2=s);const n=s})(),dateslicerDBDD84A5A032498BB55DDA8E91CBACB2=a})();